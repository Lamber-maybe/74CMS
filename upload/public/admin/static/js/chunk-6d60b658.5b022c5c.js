(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d60b658"],{2423:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return n})),r.d(t,"e",(function(){return c}));var o=r("b775"),i=r("d722");function a(e){return Object(o["a"])({url:i["a"].articleList,method:"get",params:e})}function s(e){return Object(o["a"])({url:i["a"].articleAdd,method:"post",data:e})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"post";return"post"==t?Object(o["a"])({url:i["a"].articleEdit,method:t,data:e}):Object(o["a"])({url:i["a"].articleEdit,method:t,params:e})}function n(e){return Object(o["a"])({url:i["a"].articleDelete,method:"post",data:e})}function c(e){return Object(o["a"])({url:i["a"].articleModifyState,method:"post",data:e})}},"52b5":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r("b775"),i=r("d722");function a(e){return Object(o["a"])({url:i["a"].getClassify,method:"get",params:e})}},"62cb":function(e,t,r){"use strict";r("a049")},a049:function(e,t,r){},d14d:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("编辑资讯")]),r("el-button",{staticStyle:{float:"right",padding:"0","margin-left":"14px"},attrs:{type:"text"},on:{click:function(t){return e.goto("/content/article/list")}}},[e._v(" 返回 ")]),r("el-button",{staticStyle:{float:"right",padding:"0"},attrs:{type:"text",disabled:e.issubmit},on:{click:function(t){return e.onSubmit("form")}}},[e._v(" 保存 ")])],1),r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.infoLoading,expression:"infoLoading"}],ref:"form",staticClass:"common-form",attrs:{model:e.form,"label-width":"80px",rules:e.rules,"inline-message":!0}},[r("el-form-item",{attrs:{label:"资讯标题",prop:"title"}},[r("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"资讯分类",prop:"cid"}},[r("el-select",{attrs:{placeholder:"请选择资讯分类"},model:{value:e.form.cid,callback:function(t){e.$set(e.form,"cid",t)},expression:"form.cid"}},e._l(e.articleCategory,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"缩略图"}},[r("el-upload",{staticClass:"thumb-uploader",attrs:{action:e.apiUpload,headers:e.headers,"show-file-list":!1,"on-success":e.handleThumbSuccess,"before-upload":e.beforeThumbUpload}},[e.form.thumb?r("img",{staticClass:"thumb",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus thumb-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"内容",required:"",prop:"content"}},[r("div",{staticStyle:{border:"1px solid #ccc"}},[r("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{editor:e.editor,"default-config":e.toolbarConfig}}),r("Editor",{staticStyle:{height:"400px","overflow-y":"hidden"},on:{onCreated:e.onCreated},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)]),r("el-form-item",{attrs:{label:"附件",prop:"attach"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:e.apiAttachUpload,headers:e.headers,"on-remove":e.handleRemove,"file-list":e.form.attach,"on-success":e.handleAttachSuccess,"before-upload":e.beforeAttachUpload}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传excel,word,ppt,pdf,zip,rar文件，且不超过"+e._s(e.fileupload_size)+"kb")])],1)],1),r("el-form-item",{attrs:{label:"是否显示"}},[r("el-switch",{model:{value:e.form.is_display,callback:function(t){e.$set(e.form,"is_display",t)},expression:"form.is_display"}})],1),r("el-form-item",{attrs:{label:"发布日期"}},[r("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"请选择发布日期"},model:{value:e.form.addtime,callback:function(t){e.$set(e.form,"addtime",t)},expression:"form.addtime"}})],1),r("el-form-item",{attrs:{label:"点击量",prop:"click"}},[r("el-input",{model:{value:e.form.click,callback:function(t){e.$set(e.form,"click",e._n(t))},expression:"form.click"}})],1),r("el-form-item",{attrs:{label:"排序",prop:"sort_id"}},[r("el-input",{model:{value:e.form.sort_id,callback:function(t){e.$set(e.form,"sort_id",e._n(t))},expression:"form.sort_id"}})],1),r("el-form-item",{attrs:{label:"外部链接",prop:"link_url"}},[r("el-input",{model:{value:e.form.link_url,callback:function(t){e.$set(e.form,"link_url",t)},expression:"form.link_url"}})],1),r("el-form-item",{attrs:{label:"seo关键词",prop:"seo_keywords"}},[r("el-input",{model:{value:e.form.seo_keywords,callback:function(t){e.$set(e.form,"seo_keywords",t)},expression:"form.seo_keywords"}})],1),r("el-form-item",{attrs:{label:"seo描述",prop:"seo_description"}},[r("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.form.seo_description,callback:function(t){e.$set(e.form,"seo_description",t)},expression:"form.seo_description"}})],1),r("el-form-item",{attrs:{label:"来源",prop:"source"}},[r("el-radio-group",{on:{change:e.fun_change_source},model:{value:e.form.source,callback:function(t){e.$set(e.form,"source",t)},expression:"form.source"}},[r("el-radio",{attrs:{label:"0"}},[e._v("原创")]),r("el-radio",{attrs:{label:"1"}},[e._v("转载")])],1)],1),1==e.form.source?r("el-form-item",{attrs:{label:"转载来源",prop:"source_reprint"}},[r("el-input",{attrs:{placeholder:"请输入转载来源"},model:{value:e.form.source_reprint,callback:function(t){e.$set(e.form,"source_reprint",t)},expression:"form.source_reprint"}})],1):e._e(),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"primary",disabled:e.issubmit},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")]),r("el-button",{on:{click:function(t){return e.goto("/content/article/list")}}},[e._v("返回")])],1)],1)],1)],1)},i=[],a=r("5530"),s=(r("af93"),r("b0c0"),r("a434"),r("ac1f"),r("1276"),r("2532"),r("d3b7"),r("25f0"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("caad"),r("5f87")),l=r("61f7"),n=r("2423"),c=r("52b5"),u=r("d722"),d=(r("560e"),r("4e15")),m={components:{Editor:d["a"],Toolbar:d["b"]},data:function(){var e=this,t=function(t,r,o){r=e.editor.getText(),""===r?o(new Error("请输入内容")):o()},r=function(e,t,r){""==t&&r(),Object(l["d"])(t)?r():r(new Error("请输入正确的网址"))};return{issubmit:!1,editor:null,toolbarConfig:{excludeKeys:["fullScreen"]},headers:{admintoken:Object(s["e"])()},fileupload_size:"",fileupload_ext:"",apiUpload:window.global.RequestBaseUrl+u["a"].upload,apiAttachUpload:window.global.RequestBaseUrl+u["a"].uploadAttach,articleCategory:[],form:{title:"",cid:"",content:"",attach:[],thumb:"",is_display:!0,link_url:"",seo_keywords:"",seo_description:"",addtime:"",sort_id:0,source:0,click:0,source_reprint:""},imageUrl:"",rules:{title:[{required:!0,message:"请输入资讯标题",trigger:"blur"},{max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],cid:[{required:!0,message:"请选择资讯分类",trigger:"change"}],content:[{validator:t,trigger:"blur"}],sort_id:[{type:"number",message:"排序必须为数字",trigger:"blur"}],click:[{type:"number",message:"点击量必须为数字",trigger:"blur"}],link_url:[{max:200,message:"长度在 0 到 200 个字符",trigger:"blur"},{validator:r,trigger:"blur"}],seo_keywords:[{max:100,message:"长度在 0 到 100 个字符",trigger:"blur"}],seo_description:[{max:200,message:"长度在 0 到 200 个字符",trigger:"blur"}],source_reprint:[{max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]}}},computed:{config:function(){return this.$store.state.config}},mounted:function(){},created:function(){this.fileupload_size=this.config.fileupload_size,this.fileupload_ext=this.config.fileupload_ext,this.fetchInfo()},beforeDestroy:function(){var e=this.editor;null!=e&&e.destroy()},methods:{fun_change_source:function(e){"0"===e&&(this.form.source_reprint="")},onCreated:function(e){this.editor=Object.seal(e),this.editor.getMenuConfig("uploadImage").headers={admintoken:Object(s["e"])()},this.editor.getMenuConfig("uploadImage").withCredentials=!0,this.editor.getMenuConfig("uploadImage").server=window.global.RequestBaseUrl+u["a"].uploadEditor,this.editor.getMenuConfig("uploadVideo").headers={admintoken:Object(s["e"])()},this.editor.getMenuConfig("uploadVideo").withCredentials=!0,this.editor.getMenuConfig("uploadVideo").server=window.global.RequestBaseUrl+u["a"].uploadEditorVideo},handleRemove:function(e,t){var r=this.form.attach.indexOf({name:e.name,url:e.url});this.form.attach.splice(r,1)},handleAttachSuccess:function(e,t){if(200!=e.code)return this.$message.error(e.message),!1;var r={name:e.data.name,url:e.data.url};this.form.attach.push(r)},beforeAttachUpload:function(e){var t="doc,docx,xls,xlsx,csv,ppt,pptx,pdf,zip,rar",r=e.name.split("."),o=r[r.length-1];return t.includes(o)?!(e.size/1024>this.fileupload_size)||(this.$message.error("上传文件最大为".concat(this.fileupload_size,"kb")),!1):(this.$message.error("上传文件格式不允许"),!1)},fetchInfo:function(){var e=this;this.infoLoading=!0,Object(c["a"])({type:"articleCategory"}).then((function(t){e.articleCategory=t.data;var r={id:e.$route.query.id};return Object(n["c"])(r,"get")})).then((function(t){e.form=Object(a["a"])({},t.data.info),e.form.source=e.form.source.toString(),e.form.addtime=1e3*e.form.addtime,e.form.is_display=1==e.form.is_display,e.imageUrl=t.data.imageUrl,e.infoLoading=!1})).catch((function(){}))},onSubmit:function(e){var t=this,r=this;if(1==r.form.source&&""==r.form.source_reprint)return this.$message.error("请输入转载来源"),!1;r.issubmit=!0,this.form.content=this.editor.getHtml();var o=Object(a["a"])({},this.form);this.$refs[e].validate((function(e){if(!e)return r.issubmit=!1,!1;if(o.is_display=!0===o.is_display?1:0,o.addtime){var i=new Date(o.addtime);o.addtime=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()}Object(n["c"])(o).then((function(e){return t.$message.success(e.message),setTimeout((function(){r.$router.push("/content/article/list")}),1500),!0})).catch((function(){return r.issubmit=!1,!1}))}))},handleThumbSuccess:function(e,t){if(200!=e.code)return this.$message.error(e.message),!1;this.imageUrl=URL.createObjectURL(t.raw),this.form.thumb=e.data.file_id},beforeThumbUpload:function(e){var t=e.type.split("/"),r=t[1],o=this.fileupload_ext.split(",");return o.includes(r)?!(e.size/1024>this.fileupload_size)||(this.$message.error("上传文件最大为".concat(this.fileupload_size,"kb")),!1):(this.$message.error("上传文件格式不允许"),!1)},goto:function(e){this.$router.push(e)}}},f=m,p=(r("62cb"),r("2877")),b=Object(p["a"])(f,o,i,!1,null,"21d29152",null);t["default"]=b.exports}}]);
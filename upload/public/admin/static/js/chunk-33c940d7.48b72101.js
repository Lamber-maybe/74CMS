(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33c940d7"],{"6a58":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("短链接列表")])]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection"}}),n("el-table-column",{attrs:{label:"ID",prop:"id"}}),n("el-table-column",{attrs:{label:"短码",prop:"code"}}),n("el-table-column",{attrs:{label:"备注",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.remark?n("span",{domProps:{innerHTML:e._s(t.row.remark)}}):e._e(),t.row.remark?n("span",[e._v("-")]):e._e()]}}])}),n("el-table-column",{attrs:{align:"center",label:"到期时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon-time"}),t.row.endtime?n("span",{domProps:{innerHTML:e._s(e.timeFilter(t.row.endtime))}}):n("span",[e._v("永久")])]}}])}),n("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon-time"}),n("span",[e._v(e._s(e.timeFilter(t.row.addtime)))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"创建者"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.admin_id?n("span",{domProps:{innerHTML:e._s(t.row.admin_name)}}):e._e(),t.row.admin_id<=0?n("span",[e._v("系统")]):e._e()]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(n){return e.funEdit(t.row)}}},[e._v(" 编辑 ")]),n("el-button",{attrs:{size:"small"},on:{click:function(n){return e.genQrcode(t.row)}}},[e._v(" 二维码 ")]),n("el-button",{attrs:{size:"small"},on:{click:function(n){return e.copyShort(t.row)}}},[e._v(" 复制短链 ")]),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(n){return e.funDelete(t.row)}}},[e._v(" 删除 ")])]}}])})],1),n("div",{staticClass:"spaceline"}),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.funAdd}},[e._v(" 添加 ")]),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.funDeleteBatch}},[e._v(" 删除 ")])],1),e.total>e.pagesize?n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:16}},[n("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,15,20,30,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)],1),n("el-dialog",{attrs:{title:e.form.title,visible:e.form.show,"min-width":"45%","close-on-click-modal":!0},on:{"update:visible":function(t){return e.$set(e.form,"show",t)},close:function(t){e.form.show=!1}}},[n("el-form",{ref:"form",staticClass:"common-form",attrs:{model:e.form,"label-width":"20%",rules:e.rules,"inline-message":!0}},[n("el-form-item",{attrs:{label:"源地址",prop:"url"}},[n("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),n("el-form-item",{attrs:{label:"过期时间",prop:"endtime"}},[n("el-date-picker",{staticClass:"width",attrs:{type:"date",placeholder:"请选择过期时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.form.endtime,callback:function(t){e.$set(e.form,"endtime",t)},expression:"form.endtime"}})],1),n("el-form-item",{attrs:{label:" "}},[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(" 保存 ")]),n("el-button",{on:{click:function(t){e.form.show=!1}}},[e._v(" 取 消 ")])],1)],1)],1),n("el-dialog",{attrs:{title:"短链接二维码",visible:e.qrcodeShow,width:"300px","close-on-click-modal":!0},on:{"update:visible":function(t){e.qrcodeShow=t},close:function(t){e.qrcodeShow=!1}}},[n("div",{ref:"qrcode",staticClass:"qrcode"})])],1)},r=[],i=n("30d5"),o=(n("6db4"),n("ed08")),s=n("1f57"),l=n.n(s),c=n("b775"),u={data:function(){return{tableIdarr:[],list:null,listLoading:!0,total:0,currentPage:1,pagesize:10,qrcodeShow:!1,form:{title:"",show:!1,url:"",remark:"",id:0,endtime:""},rules:{url:[{required:!0,message:"请输入要压缩的URL地址",trigger:"blur"},{pattern:/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]$/,message:"请输入正确的URL地址",trigger:"blur"}]}}},computed:{config:function(){return this.$store.state.config}},created:function(){this.fetchData()},methods:{onSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var n=Object.assign({},e.form);delete n.title,delete n.show,Object(c["a"])({url:"/short_url/save",method:"post",data:n}).then((function(t){e.$message.success(t.message),e.form.show=!1,e.fetchData()}))}}))},copyShort:function(e){var t=document.createElement("input");t.value=this.config.sitedomain.trim("/")+"/s/"+e.code,document.body.appendChild(t),t.select(),document.execCommand("Copy"),t.className="oInput",t.style.display="none",this.$message({type:"success",message:"复制成功"})},genQrcode:function(e){var t=this;this.qrcodeShow=!0,this.$nextTick((function(){t.$refs.qrcode.innerHTML="",new l.a(t.$refs.qrcode,{text:t.config.sitedomain.trim("/")+"/s/"+e.code,width:260,height:260,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.a.CorrectLevel.H})}))},timeFilter:function(e){return 0==parseInt(e)?"永久":Object(o["a"])(e,"{y}-{m}-{d} {h}:{i}")},fetchData:function(){var e=this;this.listLoading=!0;var t={page:this.currentPage,pagesize:this.pagesize};Object(c["a"])({url:"/short_url/lists",params:t}).then((function(t){e.list=t.data.list,e.listLoading=!1,e.total=parseInt(t.data.total),e.currentPage=t.data.current_page,e.pagesize=parseInt(t.data.pagesize)}))},handleSizeChange:function(e){this.pagesize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},funSearch:function(){this.fetchData()},funAdd:function(){this.form={show:!0,url:"",remark:"",endtime:"",title:"添加短链接"}},funEdit:function(e){this.form={id:e.id,show:!0,url:e.url,remark:e.remark,endtime:this.timeFilter(e.endtime),title:"编辑短链接"}},funDelete:function(e){var t=this;t.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n={id:[e.id]};Object(c["a"])({url:"/short_url/del",method:"post",data:n}).then((function(e){return t.$message.success(e.message),t.fetchData(),!0}))})).catch((function(){}))},funDeleteBatch:function(){var e=this;if(0==e.tableIdarr.length)return e.$message.error("请选择要删除的数据"),!1;e.$confirm("此操作将永久删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.tableIdarr};Object(c["a"])({url:"/short_url/del",method:"post",data:t}).then((function(t){return e.$message.success(t.message),e.fetchData(),!0}))})).catch((function(){}))},handleSelectionChange:function(e){if(this.tableIdarr=[],e.length>0){var t,n=Object(i["a"])(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.tableIdarr.push(a.id)}}catch(r){n.e(r)}finally{n.f()}}}}},d=u,f=(n("e374"),n("5d22")),m=Object(f["a"])(d,a,r,!1,null,"77e2f4aa",null);t["default"]=m.exports},"9bfb":function(e,t,n){},e374:function(e,t,n){"use strict";n("9bfb")},ed08:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n("206e"),r=(n("e18c"),n("1c2e"),n("e35a"),n("5e9f"),n("898e"),n("0d7a"),n("8c92")),i=n.n(r);function o(e,t){if(0===arguments.length)return null;var n,r=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(a["a"])(e)?n=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var i={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},o=r.replace(/{([ymdhisa])+}/g,(function(e,t){var n=i[t];return"a"===t?["日","一","二","三","四","五","六"][n]:n.toString().padStart(2,"0")}));return o}function s(e){var t={utype:e.utype,token:e.token,mobile:e.mobile,userIminfo:e.user_iminfo};i.a.set("qscms_visitor",JSON.stringify(t),{expires:7})}}}]);
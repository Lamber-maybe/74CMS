(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1527030c"],{"17c1":function(t,e,n){},"1d6f":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAclJREFUOE+dkz9oU1EUxn/fi6+1qChZhDpISwed0mp4NYtYoUvp4CDi7KL0BSfBRQTBoYJ/ikmqiNZZXQRBlyKBDqIPcRActJN/QElVhDpEXt6RJK3Na29Avds957u/7xzOucJxrBQcxuMYkAPbDaoDb0l4Rk9jTidfvu98ps6LlYIBZHNIh1zwdszqmM1Q23pOF6pxM/IHYjeDHDFPEdnugFRmgca3cZ1erLcgdruQpR6/BvVvBNgTYAC0x5G7pzA63oaUgzuIE44KIoUvAqvsG4JN75wVJsmEbHr/drZlaoC/QWRWVTEas9JIP57/qUubj2WV/FHwHjgFsqqmojG7kdtF0vvRDbEfskpQBEr/DTH7JZsdDTErd3GZVxiN28zoTnz77NS0IOVgEvGoS7/fkSZo2EE8LnUxWpJdLfTRE9eQtvzlfqRlZvdXRpyfRt5ZB2SJJDmCpwOgy06TRlxoQ64P9ZLJvgL2rhMuwvII9A1DZsGxAldUjM6srX3z33g2DxpcJ/4KNFvdnIqb3VUxai1o+gNeG96B719EOgVk3NPgC57Oa+r5rdV8CrIatNn8IIkmVypYYxkf8H4+VPhmudPACfnXKf0GxHeg+zO5LJgAAAAASUVORK5CYII="},4124:function(t,e,n){"use strict";n.d(e,"i",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"h",(function(){return r})),n.d(e,"g",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return m})),n.d(e,"a",(function(){return d}));var a=n("b775"),l=n("d722");function i(t){return Object(a["a"])({url:l["a"].marketTplList,method:"get",params:t})}function o(t){return Object(a["a"])({url:l["a"].marketTplAdd,method:"post",data:t})}function r(t){return Object(a["a"])({url:l["a"].marketTplEdit,method:"post",data:t})}function s(t){return Object(a["a"])({url:l["a"].marketTplDelete,method:"post",data:t})}function c(t){return Object(a["a"])({url:l["a"].marketTaskList,method:"get",params:t})}function u(t){return Object(a["a"])({url:l["a"].marketTaskAdd,method:"post",data:t})}function f(t){return Object(a["a"])({url:l["a"].marketTaskDelete,method:"post",data:t})}function m(t){return Object(a["a"])({url:l["a"].marketTaskRun,method:"post",data:t})}function d(t){return Object(a["a"])({url:l["a"].marketSearchMember,method:"get",params:t})}},"4c7f":function(t,e,n){"use strict";n("17c1")},"4d6d":function(t,e,n){},"52b5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("b775"),l=n("d722");function i(t){return Object(a["a"])({url:l["a"].getClassify,method:"get",params:t})}},"5a6ba":function(t,e,n){"use strict";n("4d6d")},"6b36":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("企业过期套餐提醒")])]),n("el-form",{ref:"form",staticClass:"common-form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"会员套餐",prop:"setmeal_id"}},[n("el-checkbox",{staticStyle:{"margin-right":"20px"},on:{change:t.handleCheckAllSetmeal},model:{value:t.checkSetmealAll,callback:function(e){t.checkSetmealAll=e},expression:"checkSetmealAll"}},[t._v(" 不限 ")]),n("el-checkbox-group",{on:{change:t.handleCheckedSetmealChange},model:{value:t.form.setmeal_id,callback:function(e){t.$set(t.form,"setmeal_id",e)},expression:"form.setmeal_id"}},t._l(t.options_setmeal,(function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),n("el-form-item",{attrs:{label:"到期时间",prop:"overtime"}},[n("el-select",{staticClass:"large",attrs:{placeholder:"不限"},model:{value:t.form.overtime,callback:function(e){t.$set(t.form,"overtime",e)},expression:"form.overtime"}},[n("el-option",{attrs:{label:"不限",value:-1}}),n("el-option",{attrs:{label:"已到期",value:0}}),n("el-option",{attrs:{label:"3天内",value:3}}),n("el-option",{attrs:{label:"7天内",value:7}}),n("el-option",{attrs:{label:"15天内",value:15}}),n("el-option",{attrs:{label:"30天内",value:30}}),n("el-option",{attrs:{label:"90天内",value:90}}),n("el-option",{attrs:{label:"180天内",value:180}})],1)],1),n("el-divider",{attrs:{"content-position":"left"}},[t._v("发送设置")]),n("sendConfig",{ref:"sendConfig"}),n("el-form-item",{attrs:{label:""}},[n("el-button",{attrs:{type:"primary",loading:t.submiting},on:{click:function(e){return t.onSubmit("form")}}},[t._v(" 生成任务 ")])],1)],1)],1)],1)},l=[],i=n("5530"),o=n("52b5"),r=n("e75a"),s=n("4124"),c={components:{sendConfig:r["a"]},data:function(){return{submiting:!1,checkSetmealAll:!0,options_setmeal:[],data:{target:"setmeal",title:"",content:"",send_type:[],condition:null},form:{setmeal_id:[],overtime:-1},rules:{}}},created:function(){this.fetchInfo()},methods:{fetchInfo:function(){var t=this;Object(o["a"])({type:"setmealList"}).then((function(e){t.options_setmeal=e.data})).catch((function(){}))},onSubmit:function(t){var e=this;e.$refs[t].validate((function(t){if(!t)return!1;e.$refs.sendConfig.$refs["form"].validate((function(t){if(!t)return!1;if(!0===e.submiting)return!1;e.submiting=!0;var n=Object(i["a"])({},e.$refs.sendConfig.form),a=n.title,l=n.content,o=n.send_type;e.data.title=a,e.data.content=l,e.data.send_type=o,e.data.condition=Object(i["a"])({},e.form);var r=Object(i["a"])({},e.data);Object(s["b"])(r).then((function(t){return e.submiting=!1,e.$message.success(t.message),setTimeout((function(){e.$router.push("/tool/market/list")}),1500),!0})).catch((function(){e.submiting=!1}))}))}))},handleCheckAllSetmeal:function(t){if(t)this.form.setmeal_id=[];else if(0==this.form.setmeal_id.length)return!1},handleCheckedSetmealChange:function(t){var e=t.length;this.checkSetmealAll=!(e>0)}}},u=c,f=(n("4c7f"),n("2877")),m=Object(f["a"])(u,a,l,!1,null,"67f9b9a8",null);e["default"]=m.exports},c91d:function(t,e,n){t.exports=n.p+"static/img/qrcode.3062b406.png"},e75a:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",staticClass:"common-form",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[a("el-form-item",{attrs:{label:"任务标题",prop:"title"}},[a("el-input",{staticClass:"large",attrs:{placeholder:"请输入内容"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"发送渠道",prop:"send_type"}},[a("el-checkbox-group",{model:{value:t.form.send_type,callback:function(e){t.$set(t.form,"send_type",e)},expression:"form.send_type"}},[a("el-checkbox",{attrs:{label:"message"}},[t._v("站内信")]),a("el-checkbox",{attrs:{label:"sms",disabled:""}},[t._v("短信")]),a("el-checkbox",{attrs:{label:"email"}},[t._v("Email")])],1),a("p",{staticClass:"messageBox"},[a("img",{attrs:{src:n("1d6f"),alt:""}}),t._v(" 根据相关政策要求，群发短信需报备模板，如有群发需求请"),a("span",{on:{click:function(e){return t.concatClick()}}},[t._v("联系官方客服")])])],1),a("el-form-item",{attrs:{label:"选择模板"}},[t._l(t.tplList,(function(e,n){return a("el-dropdown",{key:n,attrs:{"split-button":"",type:"text"},on:{click:function(n){return t.funUseTpl(e)}}},[t._v(" "+t._s(e.name)+" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(n){return t.funUseTpl(e)}}},[t._v(" 应用 ")]),a("el-dropdown-item",{nativeOn:{click:function(n){return t.funEditTpl(e)}}},[t._v(" 编辑 ")]),a("el-dropdown-item",{nativeOn:{click:function(n){return t.funDeleteTpl(e)}}},[t._v(" 删除 ")])],1)],1)})),a("el-button",{staticClass:"button-new-tag",staticStyle:{"margin-left":"0"},attrs:{size:"small"},on:{click:t.funAddTpl}},[t._v(" + 新建模板 ")])],2),a("el-form-item",{attrs:{label:"消息内容",prop:"content"}},[a("el-input",{staticClass:"large",attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),t.dialogVisible?a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"35%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDialog}},[a("el-form",{ref:"tplform",staticClass:"common-form",attrs:{model:t.tplform,"label-width":"100px",rules:t.tplrules}},[a("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[a("el-input",{model:{value:t.tplform.name,callback:function(e){t.$set(t.tplform,"name",e)},expression:"tplform.name"}})],1),a("el-form-item",{attrs:{label:"消息内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.tplform.content,callback:function(e){t.$set(t.tplform,"content",e)},expression:"tplform.content"}})],1),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveTpl("tplform")}}},[t._v(" 保存 ")]),a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")])],1)],1)],1):t._e(),t.messageDialogVisible?a("el-dialog",{attrs:{title:"",visible:t.messageDialogVisible,width:"377px","close-on-click-modal":!1},on:{"update:visible":function(e){t.messageDialogVisible=e},close:t.closeDialog}},[a("p",{staticClass:"messageQrcodeTxt3"},[t._v("咨询客服")]),a("p",{staticClass:"messageQrcode"},[a("img",{attrs:{src:n("c91d")}})]),a("p",{staticClass:"messageQrcodeTxt1"},[t._v("微信扫码咨询或拨打电话")]),a("p",{staticClass:"messageQrcodeTxt2"},[t._v("182-3404-5230")])]):t._e()],1)},l=[],i=n("2909"),o=n("5530"),r=n("4124"),s={data:function(){return{tplList:[],form:{title:"",send_type:[],content:""},dialogTitle:"",dialogVisible:!1,tplform:{id:"",name:"",content:""},rules:{title:[{required:!0,message:"请输入任务标题",trigger:"blur"},{max:30,message:"最大 30 个字符",trigger:"blur"}],send_type:[{required:!0,message:"请选择发送渠道",trigger:"change"}],content:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},tplrules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{max:30,message:"最大 30 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},messageDialogVisible:!1}},created:function(){this.fetchTplList()},methods:{funAddTpl:function(){this.dialogTitle="新建模板",this.dialogVisible=!0},funEditTpl:function(t){this.tplform=Object(o["a"])({},t),this.dialogTitle="编辑模板",this.dialogVisible=!0},funDeleteTpl:function(t){var e=this;Object(r["g"])({id:t.id}).then((function(t){return e.fetchTplList(),!0})).catch((function(){}))},funUseTpl:function(t){this.form.content=t.content},addTplSave:function(t,e){var n=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(r["f"])(t).then((function(t){return n.closeDialog(),n.fetchTplList(),!0})).catch((function(){}))}))},editTplSave:function(t,e){var n=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(r["h"])(t).then((function(t){return n.closeDialog(),n.fetchTplList(),!0})).catch((function(){}))}))},saveTpl:function(t){var e=this,n=Object(o["a"])({},e.tplform);parseInt(n.id)>0?e.editTplSave(n,t):e.addTplSave(n,t)},fetchTplList:function(){var t=this;Object(r["i"])({}).then((function(e){return t.tplList=Object(i["a"])(e.data.items),!0})).catch((function(){}))},closeDialog:function(){this.dialogVisible=!1,this.messageDialogVisible=!1,this.tplform={id:"",name:"",content:""}},concatClick:function(){this.messageDialogVisible=!0}}},c=s,u=(n("5a6ba"),n("2877")),f=Object(u["a"])(c,a,l,!1,null,"6c8be80b",null);e["a"]=f.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f4fc22e"],{"8baa":function(t,e,r){},"8e35":function(t,e,r){"use strict";r.d(e,"n",(function(){return i})),r.d(e,"l",(function(){return o})),r.d(e,"m",(function(){return n})),r.d(e,"f",(function(){return l})),r.d(e,"a",(function(){return s})),r.d(e,"d",(function(){return d})),r.d(e,"c",(function(){return u})),r.d(e,"e",(function(){return c})),r.d(e,"k",(function(){return m})),r.d(e,"h",(function(){return f})),r.d(e,"j",(function(){return p})),r.d(e,"i",(function(){return g})),r.d(e,"g",(function(){return h})),r.d(e,"b",(function(){return b}));var a=r("b775");r("d722");function i(t){return Object(a["a"])({url:"/shortvideo/lists",method:"get",params:t})}function o(t){return Object(a["a"])({url:"/shortvideo/audit",method:"post",data:t})}function n(t){return Object(a["a"])({url:"/shortvideo/del",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/shortvideo/ad_list",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/shortvideo/ad_add",method:"post",data:t})}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"post";return"post"==e?Object(a["a"])({url:"/shortvideo/ad_edit",method:e,data:t}):Object(a["a"])({url:"/shortvideo/ad_edit",method:e,params:t})}function u(t){return Object(a["a"])({url:"/shortvideo/ad_del",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/shortvideo/innerLinkOptions",method:"get",params:t})}function m(t){return Object(a["a"])({url:"/shortvideo/ad_cat_list",method:"get",params:t})}function f(t){return Object(a["a"])({url:"/shortvideo/ad_cat_add",method:"post",data:t})}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"post";return"post"==e?Object(a["a"])({url:"/shortvideo/ad_cat_edit",method:e,data:t}):Object(a["a"])({url:"/shortvideo/ad_cat_edit",method:e,params:t})}function g(t){return Object(a["a"])({url:"/shortvideo/ad_cat_del",method:"post",data:t})}function h(t){return Object(a["a"])({url:"/shortvideo/ad_cat_platform",method:"get",params:t})}function b(t){return Object(a["a"])({url:"/shortvideo/ad_cat_tree",method:"get",params:t})}},a925:function(t,e,r){"use strict";var a=r("8baa"),i=r.n(a);i.a},c446:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("添加广告")]),r("el-button",{staticStyle:{float:"right",padding:"0","margin-left":"14px"},attrs:{type:"text"},on:{click:function(e){return t.goto("/shortvideo/ad/list")}}},[t._v(" 返回 ")]),r("el-button",{staticStyle:{float:"right",padding:"0"},attrs:{type:"text"},on:{click:function(e){return t.onSubmit("form")}}},[t._v(" 保存 ")])],1),r("el-form",{ref:"form",staticClass:"common-form",attrs:{model:t.form,"label-width":"120px",rules:t.rules,"inline-message":!0}},[r("el-form-item",{attrs:{label:"广告标题",prop:"title"}},[r("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"广告位",prop:"cid"}},[r("el-cascader",{attrs:{options:t.adCategory,props:{expandTrigger:"hover"}},on:{change:t.handleChange},model:{value:t.form.cid,callback:function(e){t.$set(t.form,"cid",e)},expression:"form.cid"}})],1),r("el-form-item",{attrs:{required:"",label:"本地上传"}},[r("el-upload",{staticClass:"thumb-uploader",attrs:{action:t.apiUpload,headers:t.headers,"show-file-list":!1,"on-success":t.handleThumbSuccess,"before-upload":t.beforeThumbUpload}},[t.form.imageid?r("img",{staticClass:"thumb",attrs:{src:t.imageSrc}}):r("i",{staticClass:"el-icon-plus thumb-uploader-icon"})]),""!=t.size_text?r("span",{staticClass:"smalltip"},[r("i",{staticClass:"el-icon-info"}),t._v(" 建议尺寸"+t._s(t.size_text)+" ")]):t._e()],1),r("el-form-item",{attrs:{label:"或图片地址",prop:"imageurl"}},[r("el-input",{model:{value:t.form.imageurl,callback:function(e){t.$set(t.form,"imageurl",e)},expression:"form.imageurl"}})],1),r("el-form-item",{attrs:{label:"图片说明文字",prop:"explain"}},[r("el-input",{model:{value:t.form.explain,callback:function(e){t.$set(t.form,"explain",e)},expression:"form.explain"}})],1),r("el-form-item",{attrs:{label:"开始时间",prop:"starttime"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择开始时间",format:"yyyy-MM-dd HH:mm"},model:{value:t.form.starttime,callback:function(e){t.$set(t.form,"starttime",e)},expression:"form.starttime"}})],1),r("el-form-item",{attrs:{label:"结束时间",prop:"deadline"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择结束时间",format:"yyyy-MM-dd HH:mm"},model:{value:t.form.deadline,callback:function(e){t.$set(t.form,"deadline",e)},expression:"form.deadline"}})],1),r("el-form-item",{attrs:{label:"排序",prop:"sort_id"}},[r("el-input",{model:{value:t.form.sort_id,callback:function(e){t.$set(t.form,"sort_id",t._n(e))},expression:"form.sort_id"}})],1),r("el-form-item",{attrs:{label:"目标地址",prop:"target"}},[r("el-radio-group",{model:{value:t.form.target,callback:function(e){t.$set(t.form,"target",e)},expression:"form.target"}},[r("el-radio",{attrs:{label:"0"}},[t._v("自定义链接")]),r("el-radio",{attrs:{label:"1"}},[t._v("跳转站内")]),r("el-radio",{attrs:{label:"2"}},[t._v("绑定企业")])],1)],1),0==t.form.target?r("el-form-item",{attrs:{label:"自定义跳转链接",prop:"link_url"}},[r("el-input",{model:{value:t.form.link_url,callback:function(e){t.$set(t.form,"link_url",e)},expression:"form.link_url"}})],1):t._e(),1==t.form.target?r("el-form-item",{attrs:{label:"跳转站内链接",prop:"inner_link"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.inner_link,callback:function(e){t.$set(t.form,"inner_link",e)},expression:"form.inner_link"}},t._l(t.inner_options,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e(),1==t.form.target?r("el-form-item",{attrs:{label:"站内链接参数",prop:"inner_link_params"}},[r("el-input",{attrs:{placeholder:"如无参数请留空"},model:{value:t.form.inner_link_params,callback:function(e){t.$set(t.form,"inner_link_params",t._n(e))},expression:"form.inner_link_params"}}),r("span",{staticClass:"smalltip"},[r("i",{staticClass:"el-icon-info"}),t._v(" 例如：id=1&keyword=74cms ")])],1):t._e(),2==t.form.target?r("el-form-item",{attrs:{label:"企业ID",prop:"company_id"}},[r("el-input",{model:{value:t.form.company_id,callback:function(e){t.$set(t.form,"company_id",t._n(e))},expression:"form.company_id"}})],1):t._e(),r("el-form-item",{attrs:{label:"是否显示"}},[r("el-switch",{model:{value:t.form.is_display,callback:function(e){t.$set(t.form,"is_display",e)},expression:"form.is_display"}})],1),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("保存")]),r("el-button",{on:{click:function(e){return t.goto("/shortvideo/ad")}}},[t._v("返回")])],1)],1)],1)],1)},i=[],o=(r("caad"),r("d3b7"),r("ac1f"),r("2532"),r("3ca3"),r("1276"),r("ddb0"),r("2b3d"),r("5530")),n=r("5f87"),l=r("61f7"),s=r("8e35"),d=r("d722"),u={data:function(){var t=this,e=function(e,r,a){""==r&&a(),""!=t.form.starttime&&t.form.starttime>r?a(new Error("开始时间不能大于结束时间")):a()},r=function(e,r,a){""==t.form.imageid&&""==r?a(new Error("请上传图片或填写本地图片地址")):a()},a=function(t,e,r){""==e&&r(),Object(l["d"])(e)?r():r(new Error("请输入正确的网址"))},i=function(e,r,a){1==t.form.target&&""==r?a(new Error("请选择站内链接")):a()},o=function(e,r,a){2==t.form.target&&0==r?a(new Error("请填写企业ID")):a()};return{size_text:"",headers:{admintoken:Object(n["e"])()},fileupload_size:"",fileupload_ext:"",apiUpload:window.global.RequestBaseUrl+d["a"].upload,adCategory:[],inner_options:[],form:{title:"",cid:[],imageid:"",imageurl:"",explain:"",starttime:"",deadline:"",sort_id:0,target:"0",link_url:"",inner_link:"",inner_link_params:"",company_id:0,is_display:!0},imageSrc:"",rules:{title:[{required:!0,message:"请输入广告标题",trigger:"blur"},{max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],cid:[{required:!0,message:"请选择广告位",trigger:"change"}],imageurl:[{validator:r,trigger:"blur"}],explain:[{max:255,message:"长度在 0 到 255 个字符",trigger:"blur"}],starttime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],deadline:[{validator:e,trigger:"blur"}],sort_id:[{type:"number",message:"排序必须为数字",trigger:"blur"}],link_url:[{max:200,message:"长度在 0 到 200 个字符",trigger:"blur"},{validator:a,trigger:"blur"}],inner_link:[{validator:i,trigger:"change"}],company_id:[{type:"number",message:"企业ID必须为数字",trigger:"blur"},{validator:o,trigger:"blur"}]}}},computed:{config:function(){return this.$store.state.config}},mounted:function(){},created:function(){this.fileupload_size=this.config.fileupload_size,this.fileupload_ext=this.config.fileupload_ext,this.fetchCategoryData()},methods:{handleChange:function(t){var e=[];for(var r in this.adCategory){var a=this.adCategory[r];if(a.value==t[0]){e=a.children;break}}for(var i in e){var o=e[i];if(o.value==t[1]){this.size_text=o.w+"*"+o.h;break}}},fetchCategoryData:function(){var t=this;Object(s["b"])().then((function(e){return t.adCategory=e.data,t.adCategoryLoading=!1,Object(s["e"])()})).then((function(e){t.inner_options=e.data})).catch((function(){}))},onSubmit:function(t){var e=this,r=this,a=Object(o["a"])({},this.form);this.$refs[t].validate((function(t){if(!t)return!1;if(a.is_display=!0===a.is_display?1:0,a.starttime){var i=new Date(a.starttime);a.starttime=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()}if(a.deadline){var o=new Date(a.deadline);a.deadline=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate()+" "+o.getHours()+":"+o.getMinutes()}Object(s["a"])(a).then((function(t){return e.$message.success(t.message),setTimeout((function(){r.$router.push("/shortvideo/ad")}),1500),!0})).catch((function(){}))}))},handleThumbSuccess:function(t,e){if(200!=t.code)return this.$message.error(t.message),!1;this.imageSrc=URL.createObjectURL(e.raw),this.form.imageid=t.data.file_id},beforeThumbUpload:function(t){var e=t.type.split("/"),r=e[1],a=this.fileupload_ext.split(",");return a.includes(r)?!(t.size/1024>this.fileupload_size)||(this.$message.error("上传文件最大为".concat(this.fileupload_size,"kb")),!1):(this.$message.error("上传文件格式不允许"),!1)},goto:function(t){this.$router.push(t)}}},c=u,m=(r("a925"),r("2877")),f=Object(m["a"])(c,a,i,!1,null,"7a39c6de",null);e["default"]=f.exports}}]);
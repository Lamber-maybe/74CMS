(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2ce5dea","chunk-91140928"],{"1f90":function(t,e,a){"use strict";a("2d7e")},"29d5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("订单管理")])]),a("div",{staticClass:"list-search"},[a("el-select",{staticClass:"list-options",attrs:{placeholder:"不限支付状态"},on:{change:t.funSearch},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-option",{attrs:{label:"不限支付状态",value:""}}),t._l(t.options_status,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})}))],2),a("el-select",{staticClass:"list-options",attrs:{placeholder:"不限支付方式"},on:{change:t.funSearch},model:{value:t.payment,callback:function(e){t.payment=e},expression:"payment"}},[a("el-option",{attrs:{label:"不限支付方式",value:""}}),t._l(t.options_payment,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],2),a("el-select",{staticClass:"list-options",attrs:{placeholder:"不限订单类型"},on:{change:t.funSearch},model:{value:t.service_type,callback:function(e){t.service_type=e},expression:"service_type"}},[a("el-option",{attrs:{label:"不限订单类型",value:""}}),t._l(t.options_service_type,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],2),a("el-select",{staticClass:"list-options",attrs:{placeholder:"不限下单时间"},on:{change:t.funSearch},model:{value:t.add_settr,callback:function(e){t.add_settr=e},expression:"add_settr"}},[a("el-option",{attrs:{label:"不限下单时间",value:""}}),a("el-option",{attrs:{label:"3天内",value:"3"}}),a("el-option",{attrs:{label:"7天内",value:"7"}}),a("el-option",{attrs:{label:"15天内",value:"15"}}),a("el-option",{attrs:{label:"30天内",value:"30"}})],1),a("el-select",{staticClass:"list-options",attrs:{placeholder:"不限付款时间"},on:{change:t.funSearch},model:{value:t.pay_settr,callback:function(e){t.pay_settr=e},expression:"pay_settr"}},[a("el-option",{attrs:{label:"不限付款时间",value:""}}),a("el-option",{attrs:{label:"3天内",value:"3"}}),a("el-option",{attrs:{label:"7天内",value:"7"}}),a("el-option",{attrs:{label:"15天内",value:"15"}}),a("el-option",{attrs:{label:"30天内",value:"30"}})],1),a("el-select",{staticClass:"list-options",attrs:{placeholder:"按下单时间排序"},on:{change:t.funSearch},model:{value:t.sort,callback:function(e){t.sort=e},expression:"sort"}},[a("el-option",{attrs:{label:"按下单时间排序",value:""}}),a("el-option",{attrs:{label:"按付款时间排序",value:"1"}}),a("el-option",{attrs:{label:"按订单状态排序",value:"2"}})],1),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.funSearchKeyword.apply(null,arguments)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[a("el-select",{staticClass:"input-sel",attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.key_type,callback:function(e){t.key_type=e},expression:"key_type"}},[a("el-option",{attrs:{label:"企业ID",value:"1"}}),a("el-option",{attrs:{label:"企业名称",value:"2"}}),a("el-option",{attrs:{label:"会员UID",value:"3"}}),a("el-option",{attrs:{label:"会员手机号",value:"4"}}),a("el-option",{attrs:{label:"订单号",value:"5"}})],1),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.funSearchKeyword},slot:"append"})],1)],1),a("div",{staticClass:"spaceline"}),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"Loading",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"企业名称",prop:"companyname","min-width":"200"}}),a("el-table-column",{attrs:{label:"服务内容",prop:"service_name","min-width":"150"}}),a("el-table-column",{attrs:{label:"订单金额","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.amount))]}}])}),a("el-table-column",{attrs:{label:"支付方式","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[""==e.row.payment?a("span",[t._v(" - ")]):a("span",t._l(t.options_payment,(function(n,o){return a("span",{key:o},[n.id==e.row.payment?a("span",[t._v(t._s(n.name))]):t._e()])})),0)]}}])}),a("el-table-column",{attrs:{label:"订单状态","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("statusFilter")(e.row.status)}},[t._v(" "+t._s(t.options_status[e.row.status])+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"下单时间","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),a("span",[t._v(t._s(t._f("timeFilter")(e.row.addtime)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"付款时间","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.paytime>0?a("span",[a("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t._f("timeFilter")(e.row.paytime))+" ")]):a("span",[t._v("-")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"340"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.fun_detail(e.row)}}},[t._v(" 详情 ")]),0==e.row.status?a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){return t.funConfirm(e.$index,e.row)}}},[t._v(" 确认付款 ")]):t._e(),0==e.row.status?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return t.funCancel(e.$index,e.row)}}},[t._v(" 关闭 ")]):t._e(),a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.funCopy(e.row.oid)}}},[t._v(" 复制单号 ")])]}}])})],1),a("div",{staticClass:"spaceline"}),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.batch_export()}}},[t._v(" 批量导出 ")])],1),a("el-col",{attrs:{span:8}}),a("el-col",{staticStyle:{"text-align":"right"},attrs:{offset:8,span:16}},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),a("el-dialog",{attrs:{title:"订单详情",visible:t.dialogFormVisible,width:"35%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-row",[a("el-col",{attrs:{span:12}},[t._v("服务名称："+t._s(t.dialogContent.service_name))]),a("el-col",{attrs:{span:12}},[t._v("订单号："+t._s(t.dialogContent.oid))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("服务金额："+t._s(t.dialogContent.service_amount))]),a("el-col",{attrs:{span:12}},[t._v("下单时间："+t._s(t.dialogContent.addtime))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[t._v(" 折后金额："+t._s(t.dialogContent.service_amount_after_discount)+" ")]),a("el-col",{attrs:{span:12}},[t._v("支付时间："+t._s(t.dialogContent.paytime))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[t._v(" 优惠券抵扣："+t._s(t.dialogContent.deduct_amount)+" ")]),a("el-col",{attrs:{span:12}},[t._v("支付状态："+t._s(t.dialogContent.status))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[t._v(" 实付金额： "),a("span",{staticClass:"font_warning",staticStyle:{"font-weight":"bold"}},[t._v(" "+t._s(t.dialogContent.amount)+" ")])]),a("el-col",{attrs:{span:12}},[t._v("支付方式："+t._s(t.dialogContent.payment))])],1),""!=t.dialogContent.amount_detail?a("el-row",[a("el-col",{attrs:{span:24}},[t._v("支付详情："+t._s(t.dialogContent.amount_detail))])],1):t._e(),""!=t.dialogContent.note?a("el-row",[a("el-col",{staticStyle:{"line-height":"26px"},attrs:{span:24}},[t._v("备注："+t._s(t.dialogContent.note))])],1):t._e()],1),t.dialogVisible?a("el-dialog",{attrs:{title:"批量导出筛选",visible:t.dialogVisible,width:"27%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{margin:"8px 0 0 24px"}},[a("span",[t._v("订单时间：")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:t.order_time,callback:function(e){t.order_time=e},expression:"order_time"}})],1),a("div",{staticStyle:{margin:"31px 0 0 24px"}},[a("span",{staticStyle:{display:"block",float:"left","padding-right":"10px"}},[t._v("支付状态：")]),a("div",[a("el-radio",{attrs:{label:"1"},model:{value:t.pay_status,callback:function(e){t.pay_status=e},expression:"pay_status"}},[t._v("不限")]),a("el-radio",{attrs:{label:"2"},model:{value:t.pay_status,callback:function(e){t.pay_status=e},expression:"pay_status"}},[t._v("已支付")])],1)]),a("div",{staticStyle:{margin:"30px 0 0 104px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportOrder()}}},[t._v("保 存")]),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)]):t._e()],1)},o=[],i=a("b85c"),s=a("2909"),r=(a("d81d"),a("d3b7"),a("159b"),a("b0c0"),a("4e82"),a("52b5")),l=a("f8b7"),c=a("ed08"),u=a("39a0"),d={filters:{timeFilter:function(t){return Object(c["b"])(t,"{y}-{m}-{d} {h}:{i}")},statusFilter:function(t){switch(t){case 0:return"warning";case 1:return"success";case 2:return"info";default:return"info"}}},data:function(){return{dialogFormVisible:!1,dialogContent:{oid:"",service_name:"",service_amount:"",service_amount_after_discount:"",amount:"",deduct_amount:"",payment:"",addtime:"",paytime:"",status:"",amount_detail:""},status:"",payment:"",service_type:"",add_settr:"",pay_settr:"",options_status:[],options_payment:[],options_service_type:[],list:null,listLoading:!0,total:0,currentPage:1,pagesize:10,key_type:"1",keyword:"",sort:"",dialogVisible:!1,order_time:"",pay_status:"1"}},created:function(){this.fetchData()},methods:{exportExcel:function(t){var e=this;Promise.resolve().then(function(){var n=a("39a0"),o=(n.export_json_to_excel,["企业名称","订单金额","订单类型","订单号","企业联系方式","服务内容","支付方式","订单状态","下单时间","付款时间"]),i=["companyname","service_amount","service_type","oid","mobile","service_name","payment","status_text","addtime","paytime"],s=e.formatJson(i,t);Object(u["export_json_to_excel"])(o,s,"订单导出")}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))},exportOrder:function(){this.dialogVisible=!1;var t=this;if(0==t.$store.state.user.access_export)return t.$message.error("当前管理员没有导出权限"),this.order_time="",!1;Object(l["c"])({order_time:this.order_time,pay_status:parseInt(this.pay_status)}).then((function(e){t.exportExcel(e.data)})),this.order_time=""},handleClose:function(t){this.dialogVisible=!1,this.order_time=""},batch_export:function(){this.dialogVisible=!0,this.order_time=""},fetchData:function(){var t=this;this.listLoading=!0,Object(r["a"])({type:"orderStatus,orderPayment,orderServiceTypeCompany"}).then((function(e){var a=Object(s["a"])(e.data.orderStatus);a.forEach((function(e){t.options_status[e.id]=e.name})),t.options_payment=Object(s["a"])(e.data.orderPayment),t.options_service_type=Object(s["a"])(e.data.orderServiceTypeCompany);var n={utype:1,status:t.status,payment:t.payment,service_type:t.service_type,add_settr:t.add_settr,pay_settr:t.pay_settr,sort:t.sort,key_type:t.key_type,keyword:t.keyword,page:t.currentPage,pagesize:t.pagesize};return Object(l["d"])(n)})).then((function(e){t.list=e.data.items,t.listLoading=!1,t.total=e.data.total,t.currentPage=e.data.current_page,t.pagesize=e.data.pagesize})).catch((function(){}))},handleSizeChange:function(t){this.pagesize=t,this.fetchData()},handleCurrentChange:function(t){this.currentPage=t,this.fetchData()},funSearch:function(){this.fetchData()},funSearchKeyword:function(){this.currentPage=1,this.fetchData()},goto:function(t){this.$router.push(t)},fun_detail:function(t){if(this.dialogContent={oid:t.oid,service_name:t.service_name,service_amount:"￥"+t.service_amount,service_amount_after_discount:"￥"+t.service_amount_after_discount,amount:"￥"+t.amount,deduct_amount:"￥"+t.deduct_amount,addtime:Object(c["b"])(t.addtime,"{y}-{m}-{d} {h}:{i}"),paytime:0==t.paytime?"未支付":Object(c["b"])(t.paytime,"{y}-{m}-{d} {h}:{i}"),status:this.options_status[t.status],amount_detail:t.amount_detail,note:t.note},""==t.payment)this.dialogContent.payment="-";else{var e,a=Object(i["a"])(this.options_payment);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.id==t.payment){this.dialogContent.payment=n.name;break}}}catch(o){a.e(o)}finally{a.f()}}this.dialogFormVisible=!0},funCancel:function(t,e){var a=this;a.$confirm("确定关闭该订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};Object(l["a"])(t).then((function(t){return a.$message.success(t.message),a.fetchData(),!0}))})).catch((function(){}))},funConfirm:function(t,e){var a=this;this.$prompt("请输入备注","提示",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,beforeClose:function(t,n,o){if("confirm"===t){var i=n.inputValue?n.inputValue:"";n.confirmButtonLoading=!0,n.confirmButtonText="执行中...";var s={id:e.id,note:i};Object(l["b"])(s).then((function(t){return n.confirmButtonLoading=!1,o(),a.$message.success(t.message),a.fetchData(),!0}))}else o()}})},funCopy:function(t){var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.className="oInput",e.style.display="none",this.$message({type:"success",message:"复制成功"})}}},p=d,f=(a("1f90"),a("2877")),_=Object(f["a"])(p,n,o,!1,null,"0055c89b",null);e["default"]=_.exports},"2d7e":function(t,e,a){},"39a0":function(t,e,a){"use strict";a.r(e),a.d(e,"export_table_to_excel",(function(){return l})),a.d(e,"export_json_to_excel",(function(){return c}));a("d3b7"),a("c19f"),a("ace4"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7");function n(t){for(var e=[],a=t.querySelectorAll("tr"),n=[],o=0;o<a.length;++o){for(var i=[],s=a[o],r=s.querySelectorAll("td"),l=0;l<r.length;++l){var c=r[l],u=c.getAttribute("colspan"),d=c.getAttribute("rowspan"),p=c.innerText;if(""!==p&&p==+p&&(p=+p),n.forEach((function(t){if(o>=t.s.r&&o<=t.e.r&&i.length>=t.s.c&&i.length<=t.e.c)for(var e=0;e<=t.e.c-t.s.c;++e)i.push(null)})),(d||u)&&(d=d||1,u=u||1,n.push({s:{r:o,c:i.length},e:{r:o+d-1,c:i.length+u-1}})),i.push(""!==p?p:null),u)for(var f=0;f<u-1;++f)i.push(null)}e.push(i)}return[e,n]}function o(t,e){e&&(t+=1462);var a=Date.parse(t);return(a-new Date(Date.UTC(1899,11,30)))/864e5}function i(t,e){for(var a={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=t.length;++i)for(var s=0;s!=t[i].length;++s){n.s.r>i&&(n.s.r=i),n.s.c>s&&(n.s.c=s),n.e.r<i&&(n.e.r=i),n.e.c<s&&(n.e.c=s);var r={v:t[i][s]};if(null!=r.v){var l=XLSX.utils.encode_cell({c:s,r:i});"number"===typeof r.v?r.t="n":"boolean"===typeof r.v?r.t="b":r.v instanceof Date?(r.t="n",r.z=XLSX.SSF._table[14],r.v=o(r.v)):r.t="s",a[l]=r}}return n.s.c<1e7&&(a["!ref"]=XLSX.utils.encode_range(n)),a}function s(){if(!(this instanceof s))return new s;this.SheetNames=[],this.Sheets={}}function r(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}function l(t){var e=document.getElementById(t);console.log("a");var a=n(e),o=a[1],l=a[0],c="SheetJS";console.log(l);var u=new s,d=i(l);d["!merges"]=o,u.SheetNames.push(c),u.Sheets[c]=d;var p=XLSX.write(u,{bookType:"xlsx",bookSST:!1,type:"binary"});saveAs(new Blob([r(p)],{type:"application/octet-stream"}),"test.xlsx")}function c(t,e,a){var n=e;n.unshift(t);var o="SheetJS",l=new s,c=i(n);l.SheetNames.push(o),l.Sheets[o]=c;var u=XLSX.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"}),d=a||"列表";saveAs(new Blob([r(u)],{type:"application/octet-stream"}),d+".xlsx")}a("0fd4"),a("df1a"),a("1447")},"52b5":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a("b775"),o=a("d722");function i(t){return Object(n["a"])({url:o["a"].getClassify,method:"get",params:t})}},df1a:function(t,e,a){a("ac1f"),a("466d"),a("d3b7"),a("b0c0"),a("1276"),a("a15b"),a("25f0"),a("fb6a"),function(t){"use strict";if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(a){}var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},a=function(){this.data=[]},n=function(t,e,a){this.data=t,this.size=t.length,this.type=e,this.encoding=a},o=a.prototype,i=n.prototype,s=t.FileReaderSync,r=function(t){this.code=this[this.name=t]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,u=t.URL||t.webkitURL||t,d=u.createObjectURL,p=u.revokeObjectURL,f=u,_=t.btoa,m=t.atob,h=t.ArrayBuffer,b=t.Uint8Array;n.fake=i.fake=!0;while(c--)r.prototype[l[c]]=c+1;return u.createObjectURL||(f=t.URL={}),f.createObjectURL=function(t){var e,a=t.type;return null===a&&(a="application/octet-stream"),t instanceof n?(e="data:"+a,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):_?e+";base64,"+_(t.data):e+","+encodeURIComponent(t.data)):d?d.call(u,t):void 0},f.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&p&&p.call(u,t)},o.append=function(t){var a=this.data;if(b&&(t instanceof h||t instanceof b)){for(var o="",i=new b(t),l=0,c=i.length;l<c;l++)o+=String.fromCharCode(i[l]);a.push(o)}else if("Blob"===e(t)||"File"===e(t)){if(!s)throw new r("NOT_READABLE_ERR");var u=new s;a.push(u.readAsBinaryString(t))}else t instanceof n?"base64"===t.encoding&&m?a.push(m(t.data)):"URI"===t.encoding?a.push(decodeURIComponent(t.data)):"raw"===t.encoding&&a.push(t.data):("string"!==typeof t&&(t+=""),a.push(unescape(encodeURIComponent(t))))},o.getBlob=function(t){return arguments.length||(t=null),new n(this.data.join(""),t,"raw")},o.toString=function(){return"[object BlobBuilder]"},i.slice=function(t,e,a){var o=arguments.length;return o<3&&(a=null),new n(this.data.slice(t,o>1?e:this.data.length),a,this.encoding)},i.toString=function(){return"[object Blob]"},i.close=function(){this.size=this.data.length=0},a}(t);t.Blob=function(t,a){var n=a&&a.type||"",o=new e;if(t)for(var i=0,s=t.length;i<s;i++)o.append(t[i]);return o.getBlob(n)}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content||this)},f8b7:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return l}));var n=a("b775"),o=a("d722");function i(t){return Object(n["a"])({url:o["a"].orderList,method:"get",params:t})}function s(t){return Object(n["a"])({url:o["a"].orderConfirm,method:"post",data:t})}function r(t){return Object(n["a"])({url:o["a"].orderCancel,method:"post",data:t})}function l(t){return Object(n["a"])({url:o["a"].orderExport,method:"post",data:t})}}}]);